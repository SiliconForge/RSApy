from squareandmultiply import *
from fractions import gcd
import random
def campo_n_coprimos(p,q):
	phi = (p-1)*(q-1)
	return phi
def escolher_expoente(campo):
#quanto maior o expoente, mais dificil de encontrar a chave de decriptacao
	while True:
		expoente = random.randrange(1,1000000)
		if(gcd(expoente,campo)==1):
			return expoente
	return 0
def escolher_chave_privada(campo,expoente):
	for t in range (1,campo):
		chave_privada = (1+t*campo)/expoente
		if(chave_privada%1 == 0 and ((chave_privada*expoente)%campo == 1)):
			return chave_privada
	return 0
def escolher_chave_privada_super(campo,expoente):
	t=expoente
	while True:
		chave_privada = (1+t*campo)/expoente
		t = t+1
		if(chave_privada%1 == 0 and ((chave_privada*expoente)%campo == 1)):
			return chave_privada
	return 0
'''
pr,qr=97390203363106519331556366908099108090486052484629013231021475920850290934299750566444304982821136003492644234510002556460143804451759059960596881588540867712903060192161475470664499868210248351256831888049048488463413744881094543395131603923035083174554789626726628496147980654106438011205581630538242382982991454962744946623792101520254896120797322121722495982219698502130102362278883990575394724073712224375305837344066107538501882086343269191079191381202109830766659321179279133713791122699935396644306506859, 48857716014284631491405183542415798441890281573992104478795953108156376644504211896477690039049785808066221098292851803867343041957188571660072900587947042396698577573878127836128800037361008783770864493595134178432893484136141922237733277291225307653299574933464737530729619886905441477461085910244479839519105451885326373339041272508091349597896268716263207682963211329799111099904037624531252464582230421150897069969276791643888467920983043870404500953052213591821566630116619035083044016982367687704401464319
print "Campo N: " + str(pr*qr)
field = campo_n_coprimos(pr,qr)
print "Campo Phi: " + str(field)
expo = escolher_expoente(field)
print "Expoente: " + str(expo)
chave = escolher_chave_privada_super(field,expo)
print "Chave privada: "  + str(chave)
'''
